
<!DOCTYPE html>
<html>
<head>
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/>
    <meta content="text/html; charset=UTF-8">
    <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>{$siteInfo.wap_shop_title}{$seoInfo.seo_title}</title>
    <meta name="keywords" content="{$seoInfo.seo_meta}">
    <meta name="description" content="{$seoInfo.seo_desc}">

    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/pre_foot.css">
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/pro-detail.css">
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/font-awesome.min.css">
    <script src="__STATIC__/web/js/jquery-1.10.2.min.js"></script>
    <script src="__STATIC__/web/js/jquery.cookie.js"></script>
    {include file="index/auto_login"/}
    <style>
        body .sub-nav.nav-b5 dd i {margin: 3px auto 5px auto;}
        body .fixed.bottom {bottom: 0;}
        .mask-layer-loading{position: fixed;width: 100%;height: 100%;z-index: 999999;top: 0;left: 0;text-align: center;display: none;}
        .mask-layer-loading i,.mask-layer-loading img{text-align: center;color:#000000;font-size:50px;position: relative;top:50%;}
        .sub-nav.nav-b5 dd{width:25%}
    </style>
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/member_index.css">
    <style>
        .head{
            border-bottom:0;
        }
        .panel.memberhead{
            background:url(__STATIC__/template/wap/images/shoptop.png);
            background-size:100% 100%;
        }
        .member{
            width: 64%;
            float: right;
            margin-top: 26px;
            color:#fff;
        }
        .img{
            width:100%;
            margin: 5px 0;
        }
        .code{
            background: #fff;
            overflow: hidden;
        }
        .rec{
            height: 17px;
            /* margin: 5px 10px; */
            padding: 10px 20px;
            border-bottom: 1px solid #E2E1E1;
            line-height:17px;
        }

        .module-icon.memberCoupon {
            background:url(__STATIC__/template/wap/images/Coupon.png) no-repeat;
            width: 22px;
            height: 22px;
            float: left;
            margin-top: 9px;
            margin-right: 10px;
            display: inline-block;
            background-size:100% 100%;
        }
        .member-info{
            background: rgba(255,79,79, 0.8);
            float:left;
            width:33%;
            color: #fff;
            text-align: center;
            line-height:41px;
        }
        .vertical-bar{
            border-left: 1px solid rgba(250,250,250,0.6);
            height: 32px;
            vertical-align: middle;
            display: inline-block;
            margin-top:5px;
        }
        .namer{
            position: absolute;
            left: 103px;
            top: 30px;
        }
        .signin{
            position: absolute;
            left: 170px;
            top: 61px;
            border-radius: 3px;
            font-size: 10px;
            line-height: 14px;
            padding: 1px 5px;
        }
        .no{
            color: yellow;
            border: 1px solid yellow;
        }
        .yes{
            color: #fff;
            border: 1px solid #fff;
        }
        .last a{
            position: relative;
        }
        .tips{
            width: 16px;
            height: 16px;
            background: #fff;
            border:1px solid #F93F40;
            border-radius: 50%;
            font-size: 6px;
            line-height: 16px;
            text-align: center;
            color: #F93F40;
            position: absolute;
            z-index: 10;
            right: -10px;
            top: -6px;
        }
        [v-cloak]{
            display: none;
        }
    </style>
</head>
<body class="body-gray">
{include file="index/nav_bar"}
<div id="vue-main" v-cloak>
<div class="panel memberhead">
    <div class="member_head">
        <a href="{:url('personaldata')}">
            <p style="float:left;margin: 20px 0 20px 20px;position:relative;">
                <i>
                    <img :src="info.member_img==''?'__STATIC__/wap/images/noFace.png':info.member_img"/>
                </i>
            </p>
            <p class="member" style="text-align:left;margin-right: 20px;margin-top: 40px;">
                <img src="__STATIC__/template/wap/images/edit.png" style="float:right;width:20px; margin: 0 10px 0 0;">
                <span class="namer" style="font-size:14px;">{{info.member_info.login_phone}}</span>
                <span style="font-size:14px;position: absolute;font-size: 12px;top: 60px;left: 103px;">{{info.member_info.level_name}}</span>
            </p>
        </a>

        <span class="signin no" @click="signIn();" v-if="info.isSign==0">签到</span>
        <span class="signin yes" v-else>已签到</span>
        <div style="overflow: hidden;width: 100%;">
            <a href="{:url('balancewater')}" class="member-info" style="width:49.5%;">
                <span >余额&nbsp;</span><span >¥&nbsp;{{info.member_info.balance}}</span>
            </a>
            <i class="vertical-bar"></i>
            <a href="{:url('integralwater')}" class="member-info" style="float:right;width:49.5%;"><span >积分&nbsp;</span><span >{{info.member_info.point}}</span></a>
        </div>
    </div>
</div>
<div class="control">
    <div class="control_l">
        <span class="control_l_content">全部订单</span>
    </div>
    <div class="control_r"><a href="{:url('order',array('type'=>'all'))}" class="right_href">查看全部订单</a></div>
</div>

<div class="panel member-nav" >
    <ul class="fu clear" >
        <li class="last" >
            <a href="{:url('order',array('type'=>'0'))}">
                <img src="__STATIC__/template/wap/images/pay.png">
                <div class="tips" v-if="info.unpaidOrder!=0">{{info.unpaidOrder}}</div>
                <p>待付款</p>
            </a>
        </li>
        <li class="last">
            <a href="{:url('order',array('type'=>'1'))}">
                <img src="__STATIC__/template/wap/images/send.png">
                <div class="tips" v-if="info.shipmentPendingOrder!=0">{{info.shipmentPendingOrder}}</div>
                <p>待发货</p>
            </a>
        </li>
        <li class="last">
            <a href="{:url('order',array('type'=>'2'))}">
                <img src="__STATIC__/template/wap/images/recieve.png">
                <div class="tips" v-if="info.goodsNotReceivedOrder!=0">{{info.goodsNotReceivedOrder}}</div>
                <p>待收货</p>
            </a>
        </li>
        <li class="last">
            <a href="{:url('order',array('type'=>'3'))}">
                <img src="__STATIC__/template/wap/images/recieved.png">
                <div class="tips" v-if="(orderNum.recieved+orderNum.success)!=0">{{orderNum.recieved+orderNum.success}}</div>
                <p>已收货</p>
            </a>
        </li>
        <li class="last">
            <a href="{:url('order',array('type'=>'4'))}">
                <img src="__STATIC__/template/wap/images/reback.png"/>
                <div class="tips" v-if="info.refundOrder!=0">{{info.refundOrder}}</div>
                <p>退款/售后</p>
            </a>
        </li>
    </ul>
</div>
<div class='member_list'>
    <ul>
        <li>
            <a href="{:url('personalData')}">
                <i class=" module-icon personal" ></i>
                <span >个人资料</span>
                <span class='jiantou'></span>
            </a>
        </li>
        <li>
            <a href="{:url('memberAddress')}">
                <i class=" module-icon address" ></i>
                <span >收货地址</span>
                <span class='jiantou'></span>
            </a>
        </li>
        <li>
            <a href="{:url('memberCoupon')}">
                <i class=" module-icon memberCoupon" ></i>
                <span >优惠券</span>
                <span class='jiantou'></span>
            </a>
        </li>
        <li>
            <a href="{:url('myAgent')}">
                <i class=" module-icon qr_code" ></i>
                <span >代理商</span>
                <span class='jiantou'></span>
            </a>
        </li>
    </ul>
</div>
</div>
<script type="text/javascript" src="__STATIC__/vue/vue.js"></script>
<script type="text/javascript" src="__STATIC__/vue/vue-resource.js"></script>
<script type="text/javascript" src="__STATIC__/layer/layer.js"></script>
<script>
    var vueMain;
    $(function () {
        vueMain=new Vue({
            el:"#vue-main",
            data:{
                info:{
                    member_info:{user_name:''}
                },
                orderNum:{}
            },
            mounted:function () {
                this.$http.post("{:url('shop/member/memberIndex')}",{}, {
                    headers: {
                        authKey: $.cookie('authKey'),
                        sessionId: $.cookie('sessionId')
                    }
                }, {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.info=res.data.data;
                    }
                });

                this.$http.post("{:url('shop/order/getOrderStatusNum')}", {status:"0"},{
                        headers: {
                            authKey: $.cookie('authKey'),
                            sessionId: $.cookie('sessionId')
                        }
                    },
                    {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.orderNum=res.data.data;
                    }
                });

            },
            methods:{
                signIn:function () {
                    this.$http.post("{:url('shop/member/signIn')}",{}, {
                        headers: {
                            authKey: $.cookie('authKey'),
                            sessionId: $.cookie('sessionId')
                        }
                    }, {emulateJSON: true}).then(function (res) {
                        if (res.data.code == 0) {
                            layer.msg('签到成功',{shade:[0.2,"#eee"]});
                            setTimeout(function () {
                                location.reload();
                            },2000);
                        }else{
                            layer.msg(res.data.msg,{shade:[0.2,"#eee"]});
                        }
                    });
                }
            }
        });
    });
</script>
</body>
</html>