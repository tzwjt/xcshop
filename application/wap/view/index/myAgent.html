<!DOCTYPE html>
<html>
<head>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/>
    <meta content="text/html; charset=UTF-8">
    <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <title>{$siteInfo.wap_shop_title}{$seoInfo.seo_title}</title>
    <meta name="keywords" content="{$seoInfo.seo_meta}">
    <meta name="description" content="{$seoInfo.seo_desc}">

    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/font-awesome.min.css">
    <script src="__STATIC__/web/js/jquery-1.10.2.min.js"></script>
    <script src="__STATIC__/web/js/jquery.cookie.js"></script>
    {include file="index/auto_login"/}
    <style>
        body .sub-nav.nav-b5 dd i {
            margin: 3px auto 5px auto;
        }
        body .fixed.bottom {
            bottom: 0;
        }
        .mask-layer-loading {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: 999999;
            top: 0;
            left: 0;
            text-align: center;
            display: none;
        }
        .mask-layer-loading i, .mask-layer-loading img {
            text-align: center;
            color: #000000;
            font-size: 50px;
            position: relative;
            top: 50%;
        }

        .sub-nav.nav-b5 dd {
            width: 25%
        }
    </style>
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/foundation.css">
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="__STATIC__/template/wap/css/common-v4.4.css">
    <meta class="foundation-data-attribute-namespace">
    <meta class="foundation-mq-xxlarge">
    <meta class="foundation-mq-xlarge">
    <meta class="foundation-mq-large">
    <meta class="foundation-mq-medium">
    <meta class="foundation-mq-small">
    <style type="text/css">
        .button-submit {
            width: 90%;
            margin: 0 auto;
            margin-top: 50px;
        }

        .button-submit button {
            color: #FFF;
            background-color: #E03115;
            font-size: 15px;
            border: none;
            line-height: 40px;
            height: 40px;
        }

        .personal-center .side-nav {
            margin-top: 68px;
        }

        #divInfo > .side-nav > li {
            margin-left: 5px;
            margin-right: 7px;
            padding-left: 5px;
            padding-right: 0px;
            height: 35px;
            line-height: 30px;
            min-height: 35px;
            border-bottom: 1px solid #f1f1f1;
        }

        #divInfo > .side-nav > li:first-child {
            padding-bottom: 8px;
            margin-top: 0px;
            padding-top: 0px;
            height: 44px;
        }

        .value.touxiang {
            float: left;
        }

        .personal-center .side-nav {
            margin-top: 45px;
            padding-top: 7px;
        }

        .personal-center .text {
            font-size: 13px;
        }

        #divInfo > .side-nav > li.border-bottom-none {
            border-bottom: none;
        }

        #divInfo > .side-nav > li.border-bottom-none img {
            margin-right: 0px;
            border-radius: 0px;
            width: 32px;
            height: auto;
        }

        .body-gray {
            background: #f5f5f5;
        }

        .mt-55.mlr-15 input {
            box-shadow: none;
            margin: 0;
            height: 35px;
            border: none;
            max-width: 72%;
            min-width: 60%;
            display: inline-block;
        }

        .mt-55.mlr-15 > div {
            line-height: 50px;
            padding-left: 15px;
            overflow: hidden;
            background: #fff;
        }

        .mt-55.mlr-15 > div:first-child {
            margin-top: 45px;
        }

        .mt-55.mlr-15 > div > span {
            width: 28%;
            font-size: 14px;
            display: block;
            float: left;
        }

        .mt-55.mlr-15 > div > span.left-img {
            width: 16%;
        }

        .mt-55.mlr-15 > div > span > img {
            width: 26px;
            height: auto;
            float: left;
            margin-top: 16px;
        }

        .border_right {
            border-right: 1px solid #ddd;
            height: 24px;
            width: 2px;
            float: left;
            margin-top: 16px;
            margin-left: 14px;
        }

        .mt-55.mlr-15 input:focus {
            background: #fff;
        }

        .personal-center .value {
            font-size: 12px;
            color: #999;
        }

        .personal-center .value img {
            height: 40px;
            width: 40px;
            margin-right: 0px;
            border-radius: 50%;
            border: 1px solid #f5f5f5;
        }

        .personal-center .arrow, .personal-center .head-arrow {
            margin-top: 10px;
        }

        .personal-center .set_a {
            color: #29afe4;
        }

        .mt-55.mlr-15 > div.threeBind {
            padding-left: 0px;
            border-bottom: 1px solid #ddd;
            border-top: 1px solid #ddd;
            margin-top: 54px;
        }

        .mt-55.mlr-15 > div.threeBind ul {
            overflow: hidden;
            margin-left: 0.5rem;
            margin-bottom: 0px;
        }

        .mt-55.mlr-15 > div.threeBind ul li {
            overflow: hidden;
            line-height: 35px;
            margin-bottom: 0px;
        }

        .mt-55.mlr-15 > div.threeBind ul li > img:first-child {
            float: left;
            margin-top: 9px;
            max-width: 26px;
            height: auto;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a {
            display: block;
            float: left;
            border-bottom: 1px solid #ddd;
            width: 91%;
            color: #333;
            font-size: 14px;
            padding-left: 6px;
            height: 42px;
            line-height: 42px;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a:after {
            clear: both;
        }

        .mt-55.mlr-15 > div.threeBind ul li:last-child > a {
            border-bottom: 0px;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a > div {
            float: right;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a > div > span:first-child {
            color: #999;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a > div > span:first-child.wei_span {
            color: #00A0E9;
        }

        .mt-55.mlr-15 > div.threeBind ul li > a > div > span:last-child {
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            transform: rotate(-46deg);
            -ms-transform: rotate(-46deg);
            -moz-transform: rotate(-46deg);
            -webkit-transform: rotate(-46deg);
            -o-transform: rotate(-46deg);
            width: 12px;
            height: 12px;
            display: block;
            float: right;
            margin: 13px 8px 10px 0px;
        }

        .sendOutCode {
            border: 1px solid #E03115 !important;
            color: #E03115;
            padding: 0;
            width: 30px;
            background: #fff;
            border-radius: 4px;
            min-width: 25% !important;
            height: 25px;
            font-size: 12px;
            margin-left: 20px;
        }

        #vue-main {
            display: none;
        }

        .mask-layer-loading {
            display: block;
        }

        .sendOutCode[disabled] {
            border-color: #666 !important;
            color: #666;
            font-size: 0.6em !important;
        }
        .niuActive{
            background-image: url("");
        }
        [v-cloak]{
            display: none;
        }
    </style>

</head>
<body class="body-gray">
<div style="height:44px;background-color:#000;position: fixed;top:0;left: 0;width:100%;z-index:1555">
    <div style="width:100%;height: 100%;line-height: 100%;text-align: center;position: absolute;font-size:22px;color:#fff;padding-top: 10px;"
         id="title">代理商
    </div>
    <div style="width:24px;height:24px;float: left;margin-top: 10px;margin-left: 10px;position:relative;z-index:5555;">
        <a onclick="backPage()">
            <img src="__STATIC__/wap/images/back-5.png" style="width:100%;"/></a>
    </div>
    <div style="width:24px;height:24px;float: right;margin-top: 10px;margin-right: 10px;position:relative;z-index:5555;">
        <a href="{:url('index')}">
            <img src="__STATIC__/wap/images/home-5.png" style="width:100%;"/></a>
    </div>
</div>
<div id="vue-main" v-cloak>
    <div class="personal-complete">
        <div class="personal-complete-tip" id="personaltip"></div>
        <div class="personal-center" id="divInfo">
            <ul class="side-nav" id="list">
                <li style="height: auto;">
                    <a>
                        <div class="cont-value" style="padding:0px;text-align: center;">
                        <span class="value touxiang" style="display: inline-block;width:100%;text-align: center;"><img
                                src="__STATIC__/wap/images/agent.png" style="width:100px;height: 100px;"/></span>
                        </div>
                    </a>
                </li>
                <li isnew="False">
                    <a href="javascript:void(0)">
                        <div class="title">
                            <i></i>
                            <span class="text">代理商名称</span>
                        </div>
                        <div class="cont-value">
                            <i></i><span class="value">{{info.agent_name}}&nbsp;</span>
                        </div>
                    </a>
                </li>
                <li isnew="False">
                    <a href="javascript:void(0)">
                        <div class="title">
                            <i></i>
                            <span class="text">公司名称</span>
                        </div>
                        <div class="cont-value">
                            <i></i><span class="value">{{info.company_name}}</span>
                        </div>
                    </a>
                </li>
                <li isnew="False">
                    <a href="javascript:void(0)">
                        <div class="title">
                            <i></i>
                            <span class="text">代理商地址</span>
                        </div>
                        <div class="cont-value">
                            <i></i><span class="value">{{info.province}}<span v-if="info.city!=''">&nbsp;&nbsp;{{info.city}}<span
                                v-if="info.district!=''">&nbsp;&nbsp;{{info.district}}</span></span></span>
                        </div>
                    </a>
                </li>
                <li isnew="False">
                    <a href="javascript:void(0)">
                        <div class="title">
                            <i></i>
                            <span class="text">状态</span>
                        </div>
                        <div class="cont-value">
                            <i></i><span class="value">{{info.status_name}}</span>
                        </div>
                    </a>
                </li>
                <div class="button-submit">
                    <a id="logout" href="javascript:void(0)">
                        <button @click="changeAgentShow()">
                            更改代理商
                        </button>
                    </a>
                </div>

            </ul>
        </div>
    </div>

    <div id="changeAgent" style="display: none">
        <form class="mt-55 mlr-15" id="editpassword" style="display: block;background-color:#fff;margin:45px 0 0 0">
            <div onclick="showAddress()" style="position: relative;"><span style="width:100%;">地区：<span v-html="address"></span></span>
                <a style="position: absolute;right:2em;top:2px;color:#2a7ede;font-size:0.8em;">选择</a>
            </div>
            <hr v-if="agentList.length!=0" style="background-color: #f5f5f5;height:4px;margin: 0;"/>
            <h1 v-if="agentList.length!=0" style="text-align: center;font-size:1em;margin: 4px 0;">代理商列表</h1>
            <hr v-if="agentList.length!=0" style="background-color: #f5f5f5;height:4px;margin: 0;"/>
            <div v-if="agentList.length!=0" :class="{niuActive:item.id==agent_id}" @click="selectAgent(item)" style="position: relative;padding-right: 1em;border-bottom: 1px solid #f5f5f5;" v-for="(item,index) in agentList"><span style="width:100%;">{{index+1}}、{{item.agent_name}}({{item.identify_code}})</span>
                <i :class="{'icon-success':item.id==agent_id}" style="color:#2a7ede;position: absolute;right:1em;top:3px;font-size:1.6em;"></i>
            </div>
        </form>
        <div id="saveBtn" class="button-submit" style="display: block;">
        <a href="javascript:void(0)" @click="btnsave()">
            <button>更改</button>
        </a>
    </div>
    </div>
</div>
<script type="text/javascript" src="__STATIC__/vue/vue.js"></script>
<script type="text/javascript" src="__STATIC__/vue/vue-resource.js"></script>
<script type="text/javascript" src="__STATIC__/layer/layer.js"></script>
<script>
    var vueMain;
    var goback = 1;
    $(function () {
        vueMain = new Vue({
            el: "#vue-main",
            data: {
                info: {},
                agentList:[],
                agent_id:-1,
                address:'请选择所在地'
            },
            mounted: function () {
                this.$http.post("{:url('shop/member/getAgentByMember')}", {}, {
                    headers: {
                        authKey: $.cookie('authKey'),
                        sessionId: $.cookie('sessionId')
                    }
                }, {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.info = res.data.data;
                        $("#vue-main").show();
                    }
                });
            },
            methods: {
                btnsave: function () {
                    if(this.agent_id==-1){
                        layer.msg("请先选择代理商",{shade:[0.2,"#333"]});
                        return;
                    }
                    this.$http.post("{:url('shop/member/modifyAgent')}", {agent_id:this.agent_id}, {
                        headers: {
                            authKey: $.cookie('authKey'),
                            sessionId: $.cookie('sessionId')
                        }
                    }, {emulateJSON: true}).then(function (res) {
                        if (res.data.code == 0) {
                            layer.msg("代理商更改成功",{shade:[0.2,"#333"]});
                            setTimeout(function () {
                                location.reload();
                            },2000)
                        }
                    });
                },
                selectAgent:function (item) {
                  this.agent_id=item.id;
                },
                changeAgentShow: function () {
                    goback=2;
                    // $("#address-list").hide();

                    $("#address-list").hide();
                    $(".personal-complete").hide();
                    $("#changeAgent").show();
                }

            }
        });

    });

    //点击返回
    function backPage() {
        if (goback == 2) {
            location.reload();
        } else {
            window.history.back();
        }
    }
    function showAddress() {
        $("#address-list").show();
        $("#main").hide();
        $("#niu-address").show();
    }
</script>
{include file="index/address_detail2"}
</body>
</html>