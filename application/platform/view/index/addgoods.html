<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="renderer" content="webkit"/>
    <meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/>
    <title>{$platformName}</title>
    <link rel="stylesheet" type="text/css" href="__STATIC__/blue/bootstrap/css/bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/blue/css/ns_blue_common.css"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/font-awesome/css/font-awesome.min.css"/>
    <link rel="stylesheet" type="text/css" href="__STATIC__/simple-switch/css/simple.switch.three.css"/>
    <script src="__STATIC__/js/jquery-1.8.1.min.js"></script>
    <script src="__STATIC__/blue/bootstrap/js/bootstrap.js"></script>
    <script src="__STATIC__/bootstrap/js/bootstrapSwitch.js"></script>
    <script src="__STATIC__/simple-switch/js/simple.switch.js"></script>
    <script src="__STATIC__/js/jquery.unobtrusive-ajax.min.js"></script>
    <script src="__STATIC__/js/common.js"></script>
    <script src="__STATIC__/js/seller.js"></script>

    <script src="__STATIC__/admin/js/jquery-ui.min.js"></script>
    <script src="__STATIC__/admin/js/ns_tool.js"></script>
    <link rel="stylesheet" type="text/css" href="__STATIC__/blue/css/ns_table_style.css">
    <script>
        var PLATFORM_NAME = "{$platformInfo.platform_site_name}";
                var ADMINIMG = "index.php";//后台图片请求路径
                var ADMINMAIN = "index.php";//后台请求路径
                var PAGESIZE = "20";//分页显示页数
        var _STATIC = "__STATIC__";
        //上传文件路径
        var UPLOADGOODS = 'UPLOAD_GOODS';//存放商品图片
        var UPLOADGOODSCATEGORY = 'UPLOAD_GOODS_CATEGORY';////存放商品分类图片
        var IMAGEBOX = '{:url("platform/album/dialogAlbumList")}';
    </script>
    <!-- 编辑商品时，用到的JS、CSS资源 -->
    <!-- 编辑商品，公共CSS、JS文件引用 -->
    <link rel="stylesheet" type="text/css" href="__STATIC__/admin/css/product.css">
    <!-- 选择商品图，弹出框的样式 -->
    <link rel="stylesheet" type="text/css" href="__STATIC__/admin/css/defau.css">
    <link href="__STATIC__/sku/jquery.ui.css" type="text/css" rel="stylesheet">
    <link href="__STATIC__/sku/goods_create.css" type="text/css" rel="stylesheet">
    <link href="__STATIC__/sku/base.css" type="text/css" rel="stylesheet">
    <link href='__STATIC__/admin/css/drag_haul/jquery.gridly.css' rel='stylesheet' type='text/css'>
    <link href='__STATIC__/admin/css/drag_haul/sample.css' rel='stylesheet' type='text/css'>
    <link href='__STATIC__/admin/css/select_category_next.css' rel='stylesheet' type='text/css'>
    <link href="__STATIC__/admin/css/goods/editgoods.css" rel="stylesheet" type="text/css">
    <!-- 简约版 -->
    <link href="__STATIC__/blue/css/goods/add_goods.css" rel="stylesheet" type="text/css">
    <link href="__STATIC__/mycss/addgoods.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" charset="utf-8" src="__STATIC__/admin/js/ueditor/ueditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__STATIC__/admin/js/ueditor/ueditor.all.js"></script>
    <!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
    <!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
    <script type="text/javascript" charset="utf-8" src="__STATIC__/admin/js/ueditor/zh-cn.js"></script>
    <!--<script src="__STATIC__/admin/js/ajax_file_upload.js" type="text/javascript"></script>-->
    <script src="__STATIC__/admin/js/image_common.js" type="text/javascript"></script>
    <script src="__STATIC__/admin/js/kindeditor-min.js" type="text/javascript"></script>
    <!--  用  验证商品输入信息-->
    <script src="__STATIC__/admin/js/jscommon.js" type="text/javascript"></script>
    <!-- 用 ，加载数据-->
    <script src="__STATIC__/admin/js/art_dialog.source.js"></script>
    <script src="__STATIC__/admin/js/iframe_tools.source.js"></script>
    <!-- 我的图片 -->
    <script src="__STATIC__/admin/js/material_managedialog.js"></script>
    <script src="__STATIC__/js/ajax_file_upload.js" type="text/javascript"></script>
    <script src="__STATIC__/js/file_upload.js" type="text/javascript"></script>
    <!--<script src='__STATIC__/admin/js/goods/init_address.js'></script>-->
    <script type="text/javascript" src="__STATIC__/admin/js/goods/goods_sku_create.js"></script>
    <script src="__STATIC__/admin/js/goods/release_good_second.js"></script>
    <script type="text/javascript" src="__STATIC__/admin/js/plugin/jquery.toTop.min.js"></script>
    <script type="text/javascript" src="__STATIC__/My97DatePicker/WdatePicker.js"></script>
    <script type='text/javascript' src='__STATIC__/admin/js/drag_haul/sample.js'></script>

    <style>
        .upload-thumb {
            display: block !important;
            float: left;
            width: 147px !important;
            height: 147px !important;
            position: relative;
        }

        .upload-thumb img {
            width: 100%;
            height: 100%;
        }

        .img-box, .sku-img-box {
            overflow: hidden;
        }

        .off-box, .sku-off-box {
            position: absolute;
            width: 18px;
            height: 18px;
            right: 0;
            top: 0;
            line-height: 18px;
            background-color: #FFF;
            cursor: pointer;
            text-align: center;
        }

        .black-bg {
            position: absolute;
            right: 0;
            top: 0;
            left: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.3);
        }

        .img-error {
            color: red;
            height: 25px;
            line-height: 25px;
            display: none;
        }

        .radio input[type="checkbox"] {
            position: relative;
            bottom: 3px;
            right: 3px;
        }

        .category-list {
            background-color: #E6E6E6;
            float: left;
            padding-left: 10px;
            line-height: 40px;
            font-size: 1.2em;
            margin-right: 30px;
            border: none;
        }

        .category-list span {
            color: #333;
            width: 40px;
            height: 100%;
            border-left: 1px solid #fff;
            display: inline-block;
            margin-left: 10px;;
            text-align: center;
            font-weight: bolder;
            font-size: 1.5em;
            cursor: pointer;
        }

        [v-cloak] {
            display: none;
        }

        .my-btn {
            background-color: #fff;
            color: #000;
            display: inline-block;
            padding: 3px 5px;
            border: 1px solid #aaa;
        }

        .my-btn:hover {
            background-color: #fff;
        }

        em.hover:hover {
            cursor: pointer;
        }

        .my-table th, .my-table td {
            width: 80px;
            text-align: center;
        }

        .my-table td input {
            width: 80%;
        }

        .my-table, .my-table tr th, .my-table tr td {
            border: 1px solid #0094ff;
        }

        .my-table {
            border-collapse: collapse
        }
        .ns-base-header {
            z-index: 0;
        }

        #niu-stock {
            margin-top: 1em;
        }

        #niu-stock tr {
            border-bottom: 1px solid #ccc;
        }

        /*#niu-stock tr:first-child{*/
        /*border-top: 1px solid #ccc;*/
        /*!*border-left: 1px solid #ccc;*!*/
        /*!*border-right: 1px solid #ccc;*!*/

        /*}*/
        /*#niu-stock tr:last-child{*/
        /*border-top: 1px solid #ccc;*/
        /*}*/
        #niu-stock, #niu-stock tr th, #niu-stock tr td {
            border: none;
        }

        #niu-stock tr th, #niu-stock tr td {
            min-width: 150px;
            max-width: 300px;
        }
        .table tbody>tr:last-of-type{
            border-bottom-color: #ccc;
        }
    </style>
    <script>
        var timeoutID = null;//延迟双击编辑规格值
        var img_id_arr = "";//图片标识ID
        var speciFicationsFlag = 0;// 0：商品图的选择，1:商品详情的图片
        var shopImageFlag = -1;//所点击的商品图片标识
        var goodsFigure = null;//商品图对象
        // 实例化编辑器，建议使用工厂方法getEditor创建和引用编辑器实例，如果在某个闭包下引用该编辑器，直接调用UE.getEditor('editor')就能拿到相关的实例
        var ue = UE.getEditor('editor');
        var group_str = '';//标签列表
        $(function () {
            //var left = $(".ncsc-form-goods").offset().left;
            var width = $(".ncsc-form-goods").width();
//	var left = $(".btn-submit").offset().left;
            //浏览器窗口监听事件
            $(window).scroll(function () {
                var left = $(".ncsc-form-goods").offset().left;
                if ($(window).height() + $(window).scrollTop() < $(".ncsc-form-goods dl:last").offset().top) {
                    $(".btn-submit").css({
                        'position': 'fixed',
                        'bottom': 0,
                        'left': left,
                        'z-index': 10000,
                        'width': width - 30,
                        "background-color": "rgba(204,204,204,0.7)",
                        "margin": 0,
                        "padding": "15"
                    });
                } else {
                    $(".btn-submit").removeAttr("style");
                }
            });
        })
    </script>
</head>
<body>
{include file="index/head" /}
<article class="ns-base-article" id="main" v-cloak>
    <aside class="ns-base-aside">
        {include file="index/nav_left"/}
        <nav id="nav-list">
            <ul id="daohang">
                <li class="li-1 selected" onclick="showDiv('#goods-info','li-1')"><a href="javascript:;">商品信息</a></li>
                <li class="li-2" onclick="showDiv('#goods-details','li-2')"><a href="javascript:;">商品详情</a></li>
                <li class="li-3" onclick="showDiv('#goods-format','li-3')"><a href="javascript:;">商品规格</a></li>
                <li class="li-4" onclick="showDiv('#goods-num','li-4')"><a href="javascript:;">商品参数</a></li>
            </ul>
        </nav>
        <div style="height:50px;"></div>
        <div id="bottom_copyright">
            <footer>
                <img src="" id="copyright_logo"/>
                <p>
                    <span id="copyright_meta"></span>
                    <br/>
                    <span id="copyright_companyname"></span>
                    <br/>
                    <span id="copyright_desc"></span>
                </p>
            </footer>
        </div>
    </aside>
    <section class="ns-base-section">
        <!-- 操作提示 -->
        <div class="ns-warm-prompt" >
            <div class="alert alert-info">
                <button type="button" class="close" onclick="$('.ns-warm-prompt').hide();">&times;</button>
                <h4>
                    <i class="fa fa-bell"></i>
                    <span>操作提示</span>
                </h4>
                <div style="font-size:12px;text-indent:18px;">
                    商品发布
                </div>
            </div>
        </div>
        <div style="position:relative;margin:10px 0;">
            <!-- 三级导航菜单 -->
            <nav class="ns-third-menu">
                <ul>
                    <li class="selected">
                        商品发布
                    </li>
                </ul>
            </nav>
            <div class="right-side-operation">
                <ul>
                    <li><a href="{:url('goodslist')}"><i
                            class="fa fa-plus-circle"></i>&nbsp;商品列表</a></li>
                </ul>
            </div>
        </div>
        <div class="ns-main" style="padding-bottom: 100px;" v-if="is_show">
            <div class="ncsc-form-goods" id="goods-info">
                <h3 class="js-goods-info">商品信息</h3>
                <dl>
                    <dt><i class="required">*</i>商品名称：</dt>
                    <dd>
                        <input class="productname" type="text" id="title" placeholder="请输入商品名称，不能超过60个字"
                               v-model="goodInfo.title"
                               oninput='if(value.length>60){value=value.slice(0,60);$(this).next().text("商品名称不能超过60个字符").show();}'/>
                        <span class="help-inline">请填写商品名称</span>
                    </dd>
                </dl>
                <dl>
                    <dt>排序：</dt>
                    <dd>
                        <input class="productname" type="text" id="productOrder"
                               placeholder="数字越大，排名越靠前,如果为空，默认排序方式为创建时间" v-model="goodInfo.sort"
                               oninput='var re = /^[0-9]*[1-9][0-9]*$/;if(!re.test(value) || (value<0 || value>9999)){$(this).next().text("排序号只能输入0-9999的正整数").show();}else{$(this).next().text("").show();}'/>
                        <span class="help-inline">请填写排序号</span>
                    </dd>
                </dl>
                <dl>
                    <dt>副标题：</dt>
                    <dd>
                        <input class="productname" type="text" id="subTitle" placeholder="请输入副标题，不能超过60个字"
                               v-model="goodInfo.sub_title"
                               oninput='if(value.length>60){value=value.slice(0,60);$(this).next().text("副标题不能超过60个字符").show();}'/>
                        <span class="help-inline">请填写副标题</span>
                    </dd>
                </dl>
                <dl>
                    <dt>商品短标题：</dt>
                    <dd>
                        <input class="productname" type="text" id="shortTitle" placeholder="请输入商品短标题名称，不能超过60个字"
                               v-model="goodInfo.short_title"
                               oninput='if(value.length>60){value=value.slice(0,60);$(this).next().text("商品短标题不能超过60个字符").show();}'/>
                        <span class="help-inline">请填写商品短标题</span>
                    </dd>
                </dl>
                <dl>
                    <dt>单位：</dt>
                    <dd>
                        <input class="productname" type="text" id="unit" v-model="goodInfo.unit"
                               oninput='if(value.length>60){value=value.slice(0,10);$(this).next().text("商品短标题不能超过10个字符").show();}'
                               style="width: 60px;"/>
                        <span class="help-inline">请填写商品单位</span>
                    </dd>
                </dl>
                <dl>
                    <dt>关键字：</dt>
                    <dd>
                        <input class="productname" type="text" id="keyWord" v-model="goodInfo.keywords"
                               placeholder="商品关键字,能准确搜到商品的,比如 : 海尔电视|电视 之类的"
                               oninput='if(value.length>60){value=value.slice(0,60);$(this).next().text("商品关键字不能超过60个字符").show();}'/>
                        <span class="help-inline">请填写关键字</span>
                    </dd>
                </dl>
                <dl>
                    <dt>商品类型：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="radio" name="type" checked="checked"
                                                                      value="1" v-model="goodInfo.type"/> 实体商品</label>
                            <!--<label class="radio inline normal"><input type="radio" name="type" value="2"-->
                                                                      <!--v-model="goodInfo.type"/> 虚拟商品</label>-->
                            <!--<label class="radio inline normal"><input type="radio" name="type" value="3"-->
                                                                      <!--v-model="goodInfo.type"/>虚拟物品(卡密)</label>-->
                            <label class="radio inline normal"><input type="radio" name="type" value="4"
                                                                      v-model="goodInfo.type"/>组合商品</label>
                            <label class="radio inline normal"><input type="radio" name="type" value="5"
                                                                      v-model="goodInfo.type"/>原料</label>
                        </div>
                    </dd>
                </dl>
                <dl v-if="goodInfo.type==4">
                    <dt>&nbsp;</dt>
                    <dd>
                        <p>
                            <button type="button" class="btn-common" data-toggle="modal" data-target="#myModal">选择原料</button>
                        </p>
                        <table id="niu-stock" v-if="selectStock.length!=0">
                            <tr>
                                <th>原料名称</th>
                                <th>数量</th>
                                <th>单价</th>
                                <th>总价</th>
                                <th>操作</th>
                            </tr>
                            <tr v-for="(item,index) in selectStock">
                                <td><img :src="item.img" style="width:40px;height:40px"/>{{item.title}}</td>
                                <td style="text-align: center;vertical-align: middle;"><input type="number" style="width:60px;" v-model="item.number" @change="changeStockNum(index)"/></td>
                                <td style="text-align: center;vertical-align: middle;">¥{{item.price}}</td>
                                <td style="text-align: center;vertical-align: middle;">¥{{changeNumToDec(item.price*item.number,2)}}</td>
                                <td style="text-align: center;vertical-align: middle;"><img src="__STATIC__/images/del.png" style="width:20px;height:20px;cursor: pointer" @click="delStock(index)"/> </td>
                            </tr>
                            <tr>
                                <td colspan="5" style="text-align: right;vertical-align: middle;">总价：¥{{changeNumToDec(stockTotal,2)}}</td>
                            </tr>
                        </table>
                    </dd>
                </dl>
                <!--选择商品模态框Start-->
                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                        aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="myModalLabel" style="font-weight: normal;font-size:16px;">数据选择器</h4>
                            </div>
                            <div class="modal-body">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>商品</th>
                                        <th style="text-align: center;vertical-align: middle;">单价</th>
                                        <th style="text-align: center;vertical-align: middle;">操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="(item,index) in stock">
                                        <td><img :src="item.pic_cover_micro" style="width:40px;height:40px"/>{{item.title}}</td>
                                        <td style="text-align: center;vertical-align: middle;">{{item.price}}</td>
                                        <td style="text-align: center;vertical-align: middle;"><button type="button" style="color:#fff;background-color: #00AAE1;font-size:12px;border: none;" @click="addStock(index)">选择</button> </td>
                                    </tr>

                                    </tbody>
                                </table>
                            </div>
                            <div class="modal-footer" style="background-color: #fff;text-align: center;">
                                <button type="button" class="btn btn-default" style="background-color: #fff;color:#333;border:1px solid #ddd;display: inline-block;word-spacing: 1em;" data-dismiss="modal">关闭</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--选择商品模态框End-->
                <!--<dl>-->
                    <!--<dt>预售设置：</dt>-->
                    <!--<dd>-->
                        <!--<div class="controls">-->
                            <!--<label class="radio inline normal"><input type="radio" name="is_presell" checked="checked"-->
                                                                      <!--value="0" v-model="goodInfo.is_presell"/>-->
                                <!--否</label>-->
                            <!--<label class="radio inline normal"><input type="radio" name="is_presell" value="1"-->
                                                                      <!--v-model="goodInfo.is_presell"/> 是</label>-->
                        <!--</div>-->
                    <!--</dd>-->
                <!--</dl>-->
                <template v-if="goodInfo.is_presell==1">
                    <dl>
                        <dt>预售价格：</dt>
                        <dd>
                            <input class="goods_price" type="number" min="0" v-model="goodInfo.presell_price"/><em
                                class="add-on">元</em>
                            <span class="help-inline">商品市场不能为空且需是数字</span>
                        </dd>
                    </dl>
                    <dl>
                        <dt>预售时间：</dt>
                        <dd>
                            <label class="radio inline normal"><input type="checkbox" name="presell_start"
                                                                      v-model="goodInfo.presell_start"/> 开始时间</label>&nbsp;&nbsp;
                            <input type="text" class="input-medium input-common" placeholder="请选择开始日期"
                                   onclick="WdatePicker()" v-model="goodInfo.presell_time_start">
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <label class="radio inline normal"><input type="checkbox" name="presell_over"
                                                                      v-model="goodInfo.presell_over"/> 结束时间</label>&nbsp;&nbsp;
                            <input type="text" placeholder="请选择结束日期" class="input-medium input-common"
                                   onclick="WdatePicker()" v-model="goodInfo.presell_over_time">
                        </dd>
                    </dl>
                    <dl>
                        <dt>发货时间：</dt>
                        <dd>
                            <label class="radio inline normal"><input type="radio" name="presell_send_type"
                                                                      checked="checked" value="0"
                                                                      v-model="goodInfo.presell_send_type"/>固定时间&nbsp;&nbsp;
                            </label>
                            <input type="text" id="startDate" class="input-medium input-common" placeholder="请选择开始日期"
                                   onclick="WdatePicker()" v-model="goodInfo.presell_send_start_time">
                        </dd>
                    </dl>
                    <dl>
                        <dt></dt>
                        <dd>
                            <label class="radio inline normal"><input type="radio" name="presell_send_type"
                                                                      checked="checked" value="1"
                                                                      v-model="goodInfo.presell_send_type"/>购买时间&nbsp;&nbsp;
                            </label>
                            <em class="add-on" style="width:60px;">购买后</em><input class="goods_price" type="number"
                                                                                  min="0"
                                                                                  v-model="goodInfo.presell_send_time"/><em
                                class="add-on">天</em>
                        </dd>
                    </dl>
                    <dl>
                        <dt>预售结束设置</dt>
                        <dd>
                            <label class="radio inline normal"><input type="checkbox"
                                                                      v-model="goodInfo.presell_end"></label></label>
                            <em class="add-on" style="width:60px;">预售结束</em><input class="goods_price" type="number"
                                                                                   min="0"
                                                                                   v-model="goodInfo.presell_time_end"/><em
                                class="add-on" style="width:150px;">天后，商品转为正常销售</em>
                        </dd>
                    </dl>
                </template>
                <dl>
                    <dt><i class="required">*</i>商品分类：</dt>
                    <dd id="">
                        <select name="search_type" id="category" class="select-common" @change="addCategory">
                            <option value="0"></option>
                            {foreach name="category" item="vo"}
                            <option value="{$vo.id}" category-name="{$vo.category_name}">{$vo.category_name}</option>
                            {/foreach}
                        </select>
                    </dd>
                </dl>
                <dl v-cloak v-if="categoryList.length!=0">
                    <dt></dt>
                    <dd>
                        <div v-for="(item,index) in categoryList" class="category-list">
                            {{item.name}}
                            <span @click="delCategory(index)">X</span>
                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>商品属性：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="checkbox" id="is_recommend"/>
                                推荐</label>
                            <label class="radio inline normal"><input type="checkbox"
                                                                      id="is_new"/>新品</label>
                            <label class="radio inline normal"><input type="checkbox"
                                                                      id="is_hot"/>热卖</label>
                            <!--<label class="radio inline normal"><input type="checkbox" v-model="goodInfo.is_send_free"/>包邮</label>-->
                            <label class="radio inline normal"><input type="checkbox"
                                                                      id="is_member_discount"/>参与会员折扣</label>
                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt><i class="required">*</i>销售价：</dt>
                    <dd>
                        <input class="goods_price" type="number" min="0" v-model="goodInfo.price"/><em
                            class="add-on">元</em>
                        <span class="help-inline">商品销售价不能为空且需是数字</span>
                    </dd>
                </dl>
                <dl>
                    <dt>市场价：</dt>
                    <dd>
                        <input class="goods_price" type="number" min="0" v-model="goodInfo.market_price"/><em
                            class="add-on">元</em>
                        <span class="help-inline">商品市场价不能为空且需是数字</span>
                    </dd>
                </dl>
                <dl>
                    <dt>成本价：</dt>
                    <dd>
                        <input class="goods_price" type="number" min="0" v-model="goodInfo.cost_price"/><em
                            class="add-on">元</em>
                        <span class="help-inline">商品成本价不能为空且需是数字</span>
                    </dd>
                </dl>
                <dl>
                    <dt>销量：</dt>
                    <dd>
                        <input class="goods_price" type="number" id="sales" min="0" onchange="integrationChange(this);"
                               v-model="goodInfo.sales"/><em class="add-on">件</em>
                        <span class="help-inline">销量不能为空且需是正整数</span>
                    </dd>
                </dl>
                <!--<dl>-->
                    <!--<dt>运费设置：</dt>-->
                    <!--<dd>-->
                        <!--<label class="radio inline normal"><input type="radio" name="dispatch_type" checked="checked"-->
                                                                  <!--value="1" v-model="goodInfo.dispatch_type"/>统一运费&nbsp;&nbsp;-->
                        <!--</label>-->
                        <!--<input class="goods_price" type="number" min="0" v-model="goodInfo.dispatch_price"/><em-->
                            <!--class="add-on">元</em>-->
                    <!--</dd>-->
                <!--</dl>-->
                <dl>
                    <dt>标签：</dt>
                    <dd>
                        <div class="controls">
                            <!--<label class="radio inline normal"><input type="checkbox" name="quality"-->
                                                                      <!--v-model="goodInfo.cash"/>货到付款</label>-->
                            <!--<label class="radio inline normal"><input type="checkbox" name="quality"-->
                                                                      <!--v-model="goodInfo.cashier"/>是否支持现金收银台</label>-->
                            <!--<label class="radio inline normal"><input type="checkbox" name="quality"-->
                                                                      <!--v-model="goodInfo.invoice"/>是否开发票</label>-->
                            <label class="radio inline normal"><input type="checkbox" name="quality"
                                                                      id="quality"/>正品保证</label>
                            <label class="radio inline normal"><input type="checkbox" name="quality"
                                                                      id="seven"/>7天无理由退换</label>
                            <label class="radio inline normal"><input type="checkbox" name="quality"
                                                                      id="repair"/>保修</label>
                            <!--<label class="radio inline normal"><input type="checkbox" name="quality"-->
                                                                      <!--v-model="goodInfo.groups_type"/>是否支持拼团</label>-->
                            <label class="radio inline normal"><input type="checkbox" name="quality"
                                                                      id="can_no_trefund"/>是否支持退换货</label>
                            <label class="radio inline normal"><input type="checkbox" name="quality"
                                                                      id="is_main"/>是否主商品</label>


                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>状态：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="radio" name="status" value="0"
                                                                      v-model="goodInfo.status"/> 下架</label>
                            <label class="radio inline normal"><input type="radio" name="status" value="1"
                                                                      v-model="goodInfo.status"/>上架</label>
                            <label class="radio inline normal"><input type="radio" name="status" value="-1"
                                                                      v-model="goodInfo.status"/>已删除</label>
                            <!--<label class="radio inline normal"><input type="radio" name="status" value="2"-->
                                                                      <!--v-model="goodInfo.status"/>赠品上架</label>-->
                        </div>
                        <span class="span-error" style="display:block;">赠品上架之后，状态不可更改。</span>
                    </dd>
                </dl>
                <!--<dl>-->
                    <!--<dt>确认收货时间：</dt>-->
                    <!--<dd>-->
                        <!--<em class="add-on" style="width:50px;">发货后</em><input class="goods_price" type="number" min="0"-->
                                                                              <!--v-model="goodInfo.auto_receive"/><em-->
                            <!--class="add-on">天</em>-->
                        <!--<span style="font-size:13px;display: inline-block;padding-left: 2em;">0读取系统设置 -1为不自动收货</span>-->
                    <!--</dd>-->
                <!--</dl>-->
                <h3 class="js-goods-img">商品图片</h3>
                <dl>
                    <dt><i class="required">*</i>商品图片：</dt>
                    <dd>
                        <div id="goods_picture_box" class="controls"
                             style="background-color:#FFF;border: 1px solid #E9E9E9;">
                            <div class="ncsc-goods-default-pic">
                                <div class="goodspic-uplaod" style="padding: 15px;">
                                    <div class='img-box' style="min-height:160px;">
                                        <div class="upload-thumb" v-if="thumb.length==0"><img
                                                src="__STATIC__/admin/images/album/default_goods_image_240.gif"></div>
                                        <div class="upload-thumb draggable-element" v-for="(item,index) in thumb"><img
                                                nstype="goods_image" :src="item.url"><input type="hidden"
                                                                                            class="upload_img_id"
                                                                                            nstype="goods_image"
                                                                                            value="128">
                                            <div class="black-bg hide" style="display: none;">
                                                <div class="off-box" @click="delImg(index)">×</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clear"></div>
                                    <span class="img-error">最少需要一张图片作为商品主图</span>
                                    <p class="hint">上传商品图片，<font color="red">第一张图片将作为商品主图</font>,支持同时上传多张图片,多张图片之间可随意调整位置；支持jpg、gif、png格式上传或从图片空间中选择，建议使用尺寸800x800像素以上、大小不超过1M的正方形图片，上传后的图片将会自动保存在图片空间的默认分类中。
                                    </p>
                                    <div class="handle">
                                        <div class="ncsc-upload-btn">
                                            <a href="javascript:void(0);">
									<span>

                                        <input class="input-file" name="file_upload" id="uploadImg" type="file"
                                               onchange="imgGoodsUpload(this,'logo')">
                                        <!--<input style="cursor:pointer;font-size:0;" type="file" id="fileupload"-->
                                        <!--hidefocus="true" onchange="imgGoodsUpload(this,'logo')"-->
                                        <!--multiple="multiple"/>-->
									</span>
                                                <p>图片上传</p>
                                            </a>
                                        </div>
                                        <a class="ncsc-btn mt5" id="img_box" nctype="show_image"
                                           href="javascript:void(0);">从图片空间选择</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <span class="help-inline">最少需要一张图片作为商品主图</span>
                    </dd>
                </dl>
                <h3 class="js-goods-point">积分购买设置</h3>
                <dl>
                    <dt><i class="required">*</i>积分设置：</dt>
                    <dd>
                        <div class="controls">
                            <!--<label class="radio inline normal"><input type="radio" name="point_exchange_type" value="0"-->
                                                                      <!--v-model="goodInfo.point_exchange_type"/>-->
                                <!--非积分兑换</label>-->
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_1" value="1"
                                                                      v-model="goodInfo.point_exchange_type"/>只能积分兑换</label>
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_1" value="2"
                                                                      v-model="goodInfo.point_exchange_type"/>积分支付</label>
                        </div>
                    </dd>
                </dl>
                <dl id="integral-exchange" v-if="goodInfo.point_exchange_type==1">
                    <dt>积分兑换：</dt>
                    <dd>
                        <div class="controls">
                            <input id="integration_available_use" class="input-mini" min="0" type="number"
                                   onchange="integrationChange(this);" v-model="goodInfo.point_exchange"/>&nbsp;积分
                            <span class="help-inline">请设置积分</span>
                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>购买可赠送：</dt>
                    <dd>
                        <div class="controls">
                            <input id="integration_available_give" class="input-mini" min="0" type="number"
                                   onchange="integrationChange(this);" v-model="goodInfo.give_point"/>&nbsp;积分
                        </div>
                    </dd>
                </dl>
                <h3 class="js-goods-other">物流设置</h3>
                <div class="js-mask-category" style="position: fixed; width: 100%; height: 100%; top: 0px; left: 0px; right: 0px; bottom: 0px; z-index: 90; display: none; background: rgba(0, 0, 0, 0);"></div>
                <dl>
                    <dt>所在地：</dt>
                    <dd>
                        <select id="provinceSelect" v-model="goodInfo.province" @change="getCity()">
                            <option v-for="item in province" :value="item.id" v-text="item.province_name"></option>
                        </select>
                        <select id="citySelect" v-model="goodInfo.city">
                            <option v-for="item in city" :value="item.id" v-text="item.city_name"></option>
                        </select>
                    </dd>
                </dl>
                <dl>
                    <dt>运费：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_2" value="1"
                                                                      v-model="goodInfo.is_send_free"/>免邮</label>
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_2" value="0"
                                                                      v-model="goodInfo.is_send_free"/>买家承担运费</label>
                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>重量：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="0" v-model="goodInfo.weight"/>
                            <span class="">克</span>

                        </div>
                    </dd>
                </dl>

                <dl>
                    <dt>体积：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="0" v-model="goodInfo.volume"/>
                            <span class="">毫米</span>
                        </div>
                    </dd>
                </dl>
                <template v-if="goodInfo.is_send_free==0">
                <dl>
                    <dt>计件方式：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_3" value="1"
                                                                      v-model="goodInfo.shipping_fee_type"/>计件</label>
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_3" value="2"
                                                                      v-model="goodInfo.shipping_fee_type"/>体积</label>
                            <label class="radio inline normal"><input type="radio" name="point_exchange_type_3" value="3"
                                                                      v-model="goodInfo.shipping_fee_type"/>重量</label>
                        </div>
                    </dd>
                </dl>

                <dl>
                    <dt>快递公司：</dt>
                    <dd>
                        <select class="select-common" v-model="goodInfo.dispatch_id">
                            <option :value="item.id" v-for="item in expressCompany">{{item.company_name}}</option>
                        </select>
                    </dd>
                </dl>
                <dl>
                    <dt>统一运费：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="0" v-model="goodInfo.dispatch_price"/>
                            <span class="">元</span>
                            <span style="color:red;padding-left: 20px;">优先使用运费模板，如没有配置的运费模板则使用统一运费</span>
                        </div>
                    </dd>
                </dl>

                </template>





                <h3 class="js-goods-other">其他信息</h3>
                <div class="js-mask-category" style="position: fixed; width: 100%; height: 100%; top: 0px; left: 0px; right: 0px; bottom: 0px; z-index: 90; display: none; background: rgba(0, 0, 0, 0);"></div>
                <dl>
                    <dt>单次最多购买：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="0" v-model="goodInfo.max_buy"/>
                            <span class="">件</span>

                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>单次最低购买：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="1" v-model="goodInfo.min_buy"/>
                            <span class="">件</span>

                        </div>
                    </dd>
                </dl>
                <dl>
                    <dt>用户最多购买：</dt>
                    <dd>
                        <div class="controls">
                            <input type="number" class="input-mini" min="1" v-model="goodInfo.user_max_buy"/>
                            <span class="">件</span>
                        </div>
                    </dd>
                </dl>

            </div>
            <div class="ncsc-form-goods" id="goods-details">
                <h3 class="js-goods_detail">商品详情</h3>
                <dl>
                    <dt><i class="required">*</i>商品描述：</dt>
                    <dd>
                        <div class="controls" id="discripContainer">
                            <textarea id="tareaProductDiscrip" name="discripArea"
                                      style="height: 500px; width: 800px; display: none;"></textarea>
                            <!--<script id="editor" type="text/plain" style="width: 800px; height: 500px;"></script>-->
                            <div id="editor" type="text/plain" style="width: 800px; height: 500px;"></div>
                            <span class="help-inline">请填写商品描述</span>
                        </div>
                    </dd>
                </dl>
            </div>
            <div class="ncsc-form-goods" id="goods-format">
                <h3 class="js-goods-info">商品规格</h3>
                <!--<template v-if="!goodInfo.has_option">-->
                <dl>
                    <dt>编码：</dt>
                    <dd>
                        <input class="productname" type="text" placeholder="" v-model="goodInfo.goods_sn"
                               :disabled="goodInfo.has_option"/>
                    </dd>
                </dl>
                <dl>
                    <dt>条码：</dt>
                    <dd>
                        <input class="productname" type="text" placeholder="" v-model="goodInfo.product_sn"
                               :disabled="goodInfo.has_option"/>
                    </dd>
                </dl>
                <!--<dl>-->
                    <!--<dt><i class="required"></i>重量：</dt>-->
                    <!--<dd>-->
                        <!--<input class="goods_price" type="number" min="0" v-model="goodInfo.weight"-->
                               <!--:disabled="goodInfo.has_option"/><em-->
                            <!--class="add-on">克</em>-->
                    <!--</dd>-->
                <!--</dl>-->
                <!--<dl>-->
                    <!--<dt><i class="required"></i>体积：</dt>-->
                    <!--<dd>-->
                        <!--<input class="goods_price" type="number" min="0" v-model="goodInfo.volume"-->
                               <!--:disabled="goodInfo.has_option"/><em-->
                            <!--class="add-on">毫升</em>-->
                    <!--</dd>-->
                <!--</dl>-->
                <dl>
                    <dt><i class="required"></i>库存数量：</dt>
                    <dd>
                        <input class="goods_price" type="number" min="0" v-model="goodInfo.total"
                               :disabled="goodInfo.has_option"/>
                        <label class="radio inline normal"><input type="checkbox" v-model="goodInfo.show_total"
                                                                  :disabled="goodInfo.has_option"/>是否显示库存</label>
                    </dd>
                </dl>
                <dl>
                    <dt>库存配置：</dt>
                    <dd>
                        <div class="controls">
                            <label class="radio inline normal"><input type="radio" name="total_cnf" value="0"
                                                                      v-model="goodInfo.total_cnf"
                                                                      :disabled="goodInfo.has_option"/> 拍下减库存</label>
                            <label class="radio inline normal"><input type="radio" name="total_cnf" value="1"
                                                                      v-model="goodInfo.total_cnf"
                                                                      :disabled="goodInfo.has_option"/> 付款减库存</label>
                            <label class="radio inline normal"><input type="radio" name="total_cnf" value="2"
                                                                      v-model="goodInfo.total_cnf"
                                                                      :disabled="goodInfo.has_option"/>永不减库存</label>
                        </div>
                    </dd>
                </dl>
                <!--</template>-->
                <dl>
                    <dt></dt>
                    <dd style="border-left: none;">
                        <div class="controls">
                            <label class="radio inline normal"><input type="checkbox" v-model="goodInfo.has_option"/>启用商品规格</label>
                        </div>
                    </dd>
                </dl>
                <dl v-for="(item,index) in format">
                    <dt style="width:100%;text-align: left;padding-left: 13%;">
                        <input type="text" class="" style="width:40%;" placeholder="规格名称(比如：颜色、尺寸)" v-model="item.title"
                               @change="insertFormat()"><em class="add-on hover" @click="addFormatList(index)"
                                                            style="width:100px;font-size:1.2em;font-weight: bolder;background-color: #00C0FF;color:#fff;">+添加规格项</em><em
                            class="add-on hover" @click="delFormat(index)"
                            style="color:#fff;background-color: red;font-size:1.2em;font-weight: bolder;">X</em>
                    </dt>
                    <dd v-for="(item1,index1) in item.spec_item_array"
                        style="width:100%;border-left:none;padding-left: 13%;margin-left: 0;">
                        <input type="text" class="" style="width:130px" v-model="item1.title"
                               @change="insertFormat()"><em class="add-on hover" @click="delFormatList(index,index1)"
                                                            style="color:#fff;background-color: red;font-size:1.2em;font-weight: bolder;">X</em>
                    </dd>
                </dl>
                <dl v-if="goodInfo.has_option" class="list" style="padding-left: 13%;">
                    <dt style="width:100%;text-align: left">
                        <button class="btn-common my-btn" type="button" @click="addFormat()"
                                style="background-color: #00a0e9;color:#fff;"><span
                                style="font-weight: bolder;font-size:1.2em;">+</span>添加规格
                        </button>
                        <button class="btn-common my-btn" type="button" @click="getTable()"
                                style="background-color: #00a0e9;color:#fff;"><img src="__STATIC__/blue/img/clear.png"
                                                                                   style="height:19px;"/>&nbsp;刷新规格项目表
                        </button>
                    </dt>
                </dl>
                <dl v-if="tableTh.length!=0">
                    <dd style="width:100%;">
                        <table class="my-table">
                            <tr>
                                <th v-for="item in tableTh" v-text="item"></th>
                            </tr>
                            <tr v-for="(item,index) in formatInfo" class="my-tr">
                                <td v-for="item1 in item.titleList" v-text="item1"></td>
                                <td><input type="number" v-model="item.presell_price"></td>
                                <td><input type="number" v-model="item.market_price"></td>
                                <td><input type="number" v-model="item.price"></td>
                                <td><input type="number" v-model="item.cost_price"></td>
                                <td><input type="number" v-model="item.stock"></td>
                                <td><input type="number" v-model="item.weight"></td>
                                <td><input type="number" v-model="item.volume"></td>
                                <td><input type="text" v-model="item.goods_sn"></td>
                                <td><input type="text" v-model="item.product_sn"></td>
                            </tr>
                            <tr>
                                <td :colspan="formatInfo[0].titleList.length">统一设置</td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[0]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[0],'presell_price')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[1]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[1],'market_price')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[2]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[2],'price')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[3]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[3],'cost_price')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[4]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[4],'stock')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[5]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[5],'weight')">↑</em>
                                </td>
                                <td><input type="number" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[6]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[6],'volume')">↑</em>
                                </td>
                                <td><input type="text" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[7]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[7],'goods_sn')">↑</em>
                                </td>
                                <td><input type="text" style="margin: 0;display: inline-block;width:40px;"
                                           v-model="other_price[8]"><em class="add-on"
                                                                        style="margin: 0;display: inline-block;width:12px;cursor: pointer;"
                                                                        @click="setPrice(other_price[8],'item.product_sn')">↑</em>
                                </td>
                            </tr>
                        </table>
                    </dd>
                </dl>
            </div>
            <div class="ncsc-form-goods" id="goods-num">
                <h3 class="js-goods_detail">商品参数</h3>
                <dl class="list">
                    <dt>序号</dt>
                    <dd>参数名称</dd>
                    <dd>参数值</dd>
                </dl>
                <dl class="list" v-for="(item,index) in number">
                    <dt>{{index+1}}</dt>
                    <dd>
                        <input class="" type="text" placeholder="" v-model="item.title"/>
                    </dd>
                    <dd>
                        <input class="" type="text" placeholder="" v-model="item.value"/>
                        <button class="btn-common my-btn" type="button" @click="delNum(index)"><span
                                style="font-weight: bolder;font-size:1.2em;">X</span></button>
                    </dd>
                </dl>
                <dl class="list">
                    <dt style="width:100%;text-align: left">
                        <button class="btn-common my-btn" type="button" @click="addNum"><span
                                style="font-weight: bolder;font-size:1.2em;">+</span>添加参数
                        </button>
                    </dt>
                </dl>
            </div>
            <button class="btn-common" id="btnSave" type="button" style="position: fixed;bottom: 40px;right:120px;"
                    @click="saveGoodInfo()">保存商品
            </button>
        </div>
    </section>
</article>
<!-- 公共的操作提示弹出框 common-success：成功，common-warning：警告，common-error：错误，-->
<div class="common-tip-message js-common-tip">
    <div class="inner"></div>
</div>
<link rel="stylesheet" type="text/css" href="__STATIC__/admin/css/jquery-ui-private.css">
<script src="__STATIC__/admin/js/drag-arrange.js" type="text/javascript" charset="utf-8"></script>
<script src="__STATIC__/admin/js/ajax_file_upload.js" type="text/javascript"></script>
<script type="text/javascript" src="__STATIC__/js/jquery.ui.widget.js" charset="utf-8"></script>
<script type="text/javascript" src="__STATIC__/js/jquery.fileupload.js" charset="utf-8"></script>
<script type="text/javascript">
    var dataAlbum
    $(function () {
        //给图片更换位置事件
        $('.draggable-element').arrangeable();
        var album_id = $("#album_id").val();
        dataAlbum = {
            "album_id": 0,
            "type": "1,2,3,4",
            'file_path': UPLOADGOODS
        };
        // ajax 上传图片
        var upload_num = 0; // 上传图片成功数量
        $('#fileupload').fileupload({
            url: "{:url('util/ImgUpload/photoalbumupload')}",
            dataType: 'json',
            formData: dataAlbum,
            add: function (e, data) {
                $("#goods_picture_box .img-error").hide();
                $("#goods_picture_box #default_uploadimg").remove();
                //显示上传图片框
                var html = "";
                $.each(data.files, function (index, file) {
                    html += '<div class="upload-thumb draggable-element"  nstype="' + file.name + '">';
                    html += '<img nstype="goods_image" src="__STATIC__/admin/images/album/uoload_ing.gif">';
                    html += '<input type="hidden"  class="upload_img_id" nstype="goods_image" value="">';
                    html += '<div class="black-bg hide">';
                    html += '<div class="off-box">&times;</div>';
                    html += '</div>';
                    html += '</div>';
                });
                $(html).appendTo('#goods_picture_box .img-box');
                //模块可拖动事件
                $('#goods_picture_box .draggable-element').arrangeable();
                data.submit();
            }
        })

        //图片幕布出现
        $(".draggable-element").live('mouseenter', function () {
            $(this).children(".black-bg").show();
        });
        //图片幕布消失
        $(".draggable-element").live('mouseleave', function () {
            $(this).children(".black-bg").hide();
        });

        //sku图片幕布出现
        $(".sku-draggable-element").live('mouseenter', function () {
            $(this).children(".black-bg").show();
        });
        //sku图片幕布消失
        $(".sku-draggable-element").live('mouseleave', function () {
            $(this).children(".black-bg").hide();
        });
        $(".sku-off-box").live('click', function () {
            if ($(this).parent().parent().parent().find(".sku-img-box .upload-thumb").length == 1) {
                var html = "";
                html += '<div class="upload-thumb" id="default_uploadimg">';
                html += '<img nstype="goods_image" src="__STATIC__/admin/images/album/default_goods_image_240.gif">';
                html += '<input type="hidden" name="image_path" id="image_path" nstype="goods_image" value="">';
                html += '</div>';
                $(html).appendTo('.sku-img-box');
            }
            $(this).parent().parent().remove();
        });

    });
    function img_upload() {

    }
    //sku图片上传
    function file_upload(obj) {

        var spec_id = $(obj).attr("spec_id");
        var spec_value_id = $(obj).attr("spec_value_id");
        $('.sku-draggable-element' + spec_id + '-' + spec_value_id).arrangeable();
        //sku图片上传
        $(obj).fileupload({
            url: "{:url('util/ImgUpload/photoalbumupload')}",
            dataType: 'json',
            formData: dataAlbum,
            add: function (e, data) {
                var box_obj = $(this).parent().parent().parent().parent().parent().parent().parent().parent();
                var spec_id = box_obj.attr("spec_id");
                var spec_value_id = box_obj.attr("spec_value_id");
                box_obj.find(".img-error").hide();
                box_obj.find("#sku_default_uploadimg").remove();
                //显示上传图片框
                var html = "";
                $.each(data.files, function (index, file) {
                    html += '<div class="upload-thumb sku-draggable-element' + spec_id + '-' + spec_value_id + ' sku-draggable-element"  nstype="' + file.name + '">';
                    html += '<img nstype="goods_image" src="__STATIC__/admin/images/album/uoload_ing.gif">';
                    html += '<input type="hidden"  class="sku_upload_img_id" nstype="goods_image" spec_id="" spec_value_id="" value="">';
                    html += '<div class="black-bg hide">';
                    html += '<div class="sku-off-box">&times;</div>';
                    html += '</div>';
                    html += '</div>';
                });

                box_obj.find('.sku-img-box').append(html);
                //模块可拖动事件
                $('.sku-draggable-element' + spec_id + '-' + spec_value_id).arrangeable();
                data.submit();
            },
        })
    }
</script>

<script type="text/javascript">
    function PopUpCallBack(id, src, upload_type, spec_id, spec_value_id) {
        alert(src);

        switch (speciFicationsFlag) {
            case 0:
                goodInfo.thumb.push({id: id, url: src});

                break;
            case 1:

                var description = "<img src='" + src + "' />";

                ue.setContent(description, true);

                break;
        }

    }

    function setGoodsFigure(goodsFigure) {
        this.goodsFigure = goodsFigure;
    }

    //设置商品详情的图片
    function setUeditorImg() {
        speciFicationsFlag = 1;
        OpenPricureDialog("PopPicure", ADMINMAIN, 5);
    }

    /**
     *图片上传
     */
    function imgUpload(event) {
        var fileid = $(event).attr("id");
        var str = $(event).next().attr("id");
        var curr = $(event).parent();
        var parent = curr.prev().prev();
        var data = {
            'file_path': UPLOADGOODSSKU,
            'goods_path': $("#goodsId").val()
        };
    }

    /*
     * 判断资源文件是否存在
     * 2017年6月15日 19:03:12
     */
    function isResourcesExist(resources_url) {
        var exist = false;
        if (resources_url != "") {
            $.ajax(resources_url, {
                type: 'get',
                timeout: 100,
                async: false,
                success: function () {
                    exist = true;
                },
                error: function () {
                    exist = false;
                }
            });
        }
        return exist;
    }
    /**
     *扩展分类个数
     */
    var extent_sort = 0;
    $(function () {
        if (parseInt("") > 0) {
            extent_sort = parseInt("");
        }
    })
</script>
<script src="__STATIC__/js/page.js"></script>
<script>
    var platform_shopname = '{$platformInfo.platform_site_name}';
</script>
<script type="text/javascript" src="__STATIC__/admin/js/jquery-ui-private.js" charset="utf-8"></script>
<script type="text/javascript" src="__STATIC__/admin/js/jquery.timers.js"></script>
<script type="text/javascript" src="__STATIC__/vue/vue.js"></script>
<script type="text/javascript" src="__STATIC__/vue/vue-resource.js"></script>
<script type="text/javascript" src="__STATIC__/layer/layer.js"></script>
<div id="dialog"></div>
<script type="text/javascript">
    var goodInfo;
    $(function () {
        $('.ncsc-form-goods').hide();
        $('.ncsc-form-goods:eq(0)').show();
        goodInfo = new Vue({
            el: "#main",
            data: {
                tableTh: [],
                province: '',//省
                city: '',//市
                categoryList: [],//分类
                number: [],//参数
                format: [],//规格
                formatInfo: [],
                other_price: [],
                thumb: [],
                //产品信息
                goodInfo: {
                    category_id: '',
                    ex_category_ids: '',
                    sort: '',
                    status: 1,
                    title: '',
                    sub_title: '',
                    short_title: '',
                    keywords: '',
                    type: 1,
                    is_new: 0,
                    is_hot: 0,
                    is_recommend: 0,
                    is_member_discount: 0,
                    product_price: '',
                    market_price: '',
                    cost_price: '',
                    thumb: '',
                    thumb_url: [],
                    thumb_first: 1,
                    sales: 0,
                    sales_real: '',
                    province: '',
                    city: '',
                    dispatch_type: 1,
                    dispatch_id: '',
                    dispatch_price: '',
                    cash: 0,
                    cashier: 0,
                    invoice: 0,
                    repair: 0,
                    seven: 0,
                    quality: 0,
                    groups_type: 0,
                    can_no_trefund: 0,
                    auto_receive: '',
                    is_presell: 0,
                    presell_price: '',
                    presell_over: false,
                    presell_over_time: '',
                    presell_start: false,
                    presell_time_start: '',
                    presell_end: '',
                    presell_time_end: '',
                    presell_send_type: 0,
                    presell_send_start_time: '',
                    presell_send_time: '',
                    goods_sn: '',
                    product_sn: '',
                    total: '',
                    total_cnf: 0,
                    show_total: false,
                    min_stock_alarm: '',
                    content: '',
                    virtual: '',
                    virtual_send: '',
                    virtual_send_content: '',
                    weight: '',
                    volume: '',
                    has_option: false,
                    view_count: '',
                    max_buy: '',
                    user_max_buy: '',
                    min_buy: '',
                    point_exchange_type: 0,
                    point_exchange: '',
                    give_point: '',
                    spec_array: [],
                    goods_sku_array: [],
                    goods_param_array: [],
                    comb_goods_array:[],
                    is_send_free:1,
                    dispatch_price:0,
                    dispatch_id:'',
                    shipping_fee_type:1
                },
                stock:[],
                selectStock:[],
                comb_id:0,
                is_show:true,
                expressCompany:[]
            },
            created: function () {
                this.$http.post("{:url('platform/Goods/getExpressCompanyList')}", {},
                    {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.expressCompany=res.data.data.data;
                    }
                });
                this.$http.post("{:url('goods/getProvince')}", {},
                        {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.province = res.data.data;
                    }
                });
                //获取原料信息
                this.$http.post("{:url('goods/getGoodsListByType')}", {type:5},
                        {emulateJSON: true}).then(function (res) {
                    if (res.data.code == 0) {
                        this.stock = res.data.data.data;

                    }
                });


                if ("{$id}" != '') {
                    this.$http.post("{:url('goods/goodsSelect')}", {goods_id: "{$id}"},
                            {emulateJSON: true}).then(function (res) {
                        if (res.data.code == 0) {
                            delete res.data.data.update_time;
                            delete res.data.data.create_time;
                            this.goodInfo = res.data.data;
                            this.goodInfo.has_option = this.goodInfo.has_option == 1 ? true : false;
                            this.goodInfo['goods_id'] = res.data.data.id;

                            this.setIsCheck();


                            //分类解析
                            this.categoryList.push({id: this.goodInfo.category_id, name: this.goodInfo.category_name});
                            for (i = 0; i < this.goodInfo.ex_category.length; i++) {
                                this.categoryList.push({
                                    id: this.goodInfo.ex_category[i].ex_category_id,
                                    name: this.goodInfo.ex_category[i].ex_category_name
                                });
                            }
                            //参数解析
                            for (i = 0; i < this.goodInfo.param_list.length; i++) {
                                this.number.push({
                                    param_id: this.goodInfo.param_list[i].id,
                                    goods_id: this.goodInfo.param_list[i].goods_id,
                                    title: this.goodInfo.param_list[i].title,
                                    value: this.goodInfo.param_list[i].value,
                                    sort: ''
                                });
                            }

                            //解析规格
//                            this.format.push({spec_id:'',goods_id:'',title:'',sort:'',spec_item_array:[]});
                            var index = 1;
                            for (i = 0; i < this.goodInfo.spec_list.length; i++) {
                                this.format.push({
                                    spec_id: this.goodInfo.spec_list[i].id,
                                    goods_id: this.goodInfo.spec_list[i].goods_id,
                                    title: this.goodInfo.spec_list[i].title,
                                    sort: this.goodInfo.spec_list[i].sort,
                                    spec_item_array: []
                                });
//                                this.format[this.format.length-1].spec_item_array
                                for (j = 0; j < this.goodInfo.spec_list[i].spec_item_list.length; j++) {
                                    this.format[i].spec_item_array.push({
                                        spec_item_id: this.goodInfo.spec_list[i].spec_item_list[j].id,
                                        item_id: index,
                                        spec_id: this.goodInfo.spec_list[i].spec_item_list[j].spec_id,
                                        title: this.goodInfo.spec_list[i].spec_item_list[j].title,
                                        thumb: this.goodInfo.spec_list[i].spec_item_list[j].thumb,
                                        sort: this.goodInfo.spec_list[i].spec_item_list[j].sort,
                                    });
                                    index++;
                                }
                            }
                            if (this.format.length != 0) {
                                //创建表格
                                this.tableTh = [];
                                this.formatInfo = [];
                                var arr = ['预售价', '市场价', '现价', '成本价', '库存', '重量', '体积', '编码', '条码'];
                                var arrNum = [];
                                for (i = 0; i < this.format.length; i++) {
                                    this.tableTh.push(this.format[i].title);
                                    arrNum[i] = 0;
                                }
                                this.tableTh = this.tableTh.concat(arr);
                                var index = arrNum.length - 1;
                                this.formatInfo = [];
                                for (i = 0; i < this.goodInfo.sku_list.length; i++) {
                                    this.formatInfo.push({
                                        titleList: this.goodInfo.sku_list[i].title.split("+"),
                                        sku_id: this.goodInfo.sku_list[i].id,
                                        sku_item_id: "",
                                        goods_id: this.goodInfo.sku_list[i].goods_id,
                                        title: this.goodInfo.sku_list[i].title,
                                        thumb: this.goodInfo.sku_list[i].thumb,
                                        presell_price: this.goodInfo.sku_list[i].presell_price,
                                        market_price: this.goodInfo.sku_list[i].market_price,
                                        price: this.goodInfo.sku_list[i].price,
                                        cost_price: this.goodInfo.sku_list[i].cost_price,
                                        stock: this.goodInfo.sku_list[i].stock,
                                        weight: this.goodInfo.sku_list[i].weight,
                                        volume: this.goodInfo.sku_list[i].volume,
                                        goods_sn: this.goodInfo.sku_list[i].goods_sn,
                                        product_sn: this.goodInfo.sku_list[i].product_sn,
                                        specs: this.goodInfo.sku_list[i].specs
                                    });
                                }
                            }
                            for (arrIndex = 0; arrIndex < this.formatInfo.length; arrIndex++) {

                                var arr = this.formatInfo[arrIndex].title.split("+");
                                for (i = 0; i < arr.length; i++) {
                                    for (j = 0; j < this.format[i].spec_item_array.length; j++) {
                                        if (arr[i] == this.format[i].spec_item_array[j].title) {
                                            if (i == arr.length - 1) {
                                                this.formatInfo[arrIndex].sku_item_id += this.format[i].spec_item_array[j].item_id;
                                            } else {
                                                this.formatInfo[arrIndex].sku_item_id += this.format[i].spec_item_array[j].item_id + ",";
                                            }
                                        }
                                    }
                                }
                            }
                            if (this.goodInfo.thumb != '') {


                                this.thumb.push({
                                    id: this.goodInfo.thumb_info.id,
                                    url: this.goodInfo.thumb_info.pic_cover_small
                                });
                                for (i = 0; i < this.goodInfo.thumb_url_list.length; i++) {
                                    this.thumb.push({
                                        id: this.goodInfo.thumb_url_list[i].id,
                                        url: this.goodInfo.thumb_url_list[i].pic_cover_small
                                    });
                                }
                            }

                            //设置文本信息
                            ue.ready(function () {
                                ue.setContent(goodInfo.goodInfo.content);
                            });
                            //组合商品信息
                            if(this.goodInfo.type==4){
                                this.goodInfo.selectStock=[];
                                for(i=0;i<this.goodInfo.comb_goods_list.length;i++){
                                    this.selectStock.push({id:this.goodInfo.comb_goods_list[i].id,goods_id:this.goodInfo.comb_goods_list[i].comb_goods_id,title:this.goodInfo.comb_goods_list[i].title,number:this.goodInfo.comb_goods_list[i].num,img:this.goodInfo.comb_goods_list[i].thumb.pic_cover_micro,price:this.goodInfo.comb_goods_list[i].price});
                                }
                            }
                            console.log(this.goodInfo);

                        }
                    });
                }else{
                   this.setIsCheck();
                }
            },
            methods: {
                setIsCheck:function () {
                    $("#is_new").attr("checked",this.goodInfo.is_new==1?true:false);
                    $("#is_hot").attr("checked",this.goodInfo.is_hot==1?true:false);
                    $("#is_recommend").attr("checked",this.goodInfo.is_recommend==1?true:false);
                    $("#is_member_discount").attr("checked",this.goodInfo.is_member_discount==1?true:false);
                    $("#quality").attr("checked",this.goodInfo.quality==1?true:false);
                    $("#seven").attr("checked",this.goodInfo.seven==1?true:false);
                    $("#repair").attr("checked",this.goodInfo.repair==1?true:false);
                    $("#can_no_trefund").attr("checked",this.goodInfo.can_no_trefund==1?true:false);
                    $("#is_main").attr("checked",this.goodInfo.is_main==1?true:false);

                },
                addCategory: function () {
                    if (this.categoryList.length > 3) {
                        return;
                    }
                    var id = $("#category").val();
                    var name = $("#category option:selected").attr('category-name');
                    for (i = 0; i < this.categoryList.length; i++) {
                        if (this.categoryList[i].id == id) {
                            return;
                        }
                    }
                    this.categoryList.push({id: id, name: name});
                    $("#category").val(0)
                },
                delCategory: function (index) {
                    this.categoryList.splice(index, 1);
                },
                addNum: function () {
                    this.number.push({param_id: '', goods_id: '', title: '', value: '', sort: ''});
                },
                delNum: function (index) {
                    this.number.splice(index, 1);
                },
                getCity: function () {
                    if (this.goodInfo.province == '')return '';
                    this.$http.post("{:url('goods/getCity')}", {province_id: this.goodInfo.province},
                            {emulateJSON: true}).then(function (res) {
                        if (res.data.code == 0) {
                            this.city = res.data.data;
                        }
                    });
                },
                saveGoodInfo: function () {
                    //获取分类信息
                    if (this.categoryList.length == 0) {
                        layer.alert('商品分类不能为空', {icon: 6, title: '提示'});
                        return;
                    }
                    if (this.categoryList.length > 0) {
                        this.goodInfo.category_id = this.categoryList[0].id;
                    }
                    if (this.categoryList.length == 2) {
                        this.goodInfo.ex_category_ids = this.categoryList[1].id;
                    }
                    if (this.categoryList.length == 3) {
                        this.goodInfo.ex_category_ids = this.categoryList[1].id + "," + this.categoryList[2].id;
                    }
                    if (this.goodInfo.has_option && this.formatInfo == '') {
                        layer.alert('选择启用商品规格后，必须生成规格表', {icon: 6, title: '提示'});
                        return;
                    }
                    if (this.thumb.lengt < 1) {
                        layer.alert('商品至少包含一张图片', {icon: 6, title: '提示'});
                        return;
                    }
                    //规格排序
                    this.goodInfo.spec_array = this.format;
                    this.goodInfo.goods_sku_array = this.formatInfo;
                    for (i = 0; i < this.goodInfo.goods_sku_array.length; i++) {
                        this.goodInfo.goods_sku_array[i].sort = i + 1;
                    }
                    //参数验证
                    for (i = 0; i < this.number.length; i++) {
                        if (this.number[i]['title'] == '' || this.number[i]['value'] == '') {
                            layer.alert('参数名称和值都不能为空', {icon: 6, title: '提示'});
                            return;
                        }
                        this.number[i].sort = i + 1;
                    }
                    this.goodInfo.goods_param_array = this.number;
                    if (this.thumb == "") {
                        layer.msg("商品至少包含一张商品图片");
                        return;
                    }
                    this.goodInfo.thumb = this.thumb[0].id;
                    this.goodInfo.thumb_url = '';
                    if (this.thumb.length > 1) {
                        for (i = 1; i < this.thumb.length; i++) {
                            if (i == this.thumb.length - 1) {
                                this.goodInfo.thumb_url += this.thumb[i].id;
                            } else {
                                this.goodInfo.thumb_url += this.thumb[i].id + ",";
                            }
                        }
                    }
                    //获取文本信息
                    this.goodInfo.content = ue.getContent();
                    //获取原材料type=4
                    if(this.goodInfo.type==4){
                        if(this.selectStock.length==0){
                            layer.alert('组合商品必须包含至少一个原材料', {icon: 6, title: '提示'});
                            return;
                        }
                        this.goodInfo.comb_goods_array=[];
                        for(i=0;i<this.selectStock.length;i++){
                            this.goodInfo.comb_goods_array.push({
                                comb_id:this.selectStock[i].id,
                                comb_goods_id:this.selectStock[i].goods_id,
                                sort:i+1,
                                num:this.selectStock[i].number
                            });
                        }
                    }
                    //得到选中信息
                    this.goodInfo.is_new=$("#is_new").attr("checked")?1:0;
                    this.goodInfo.is_hot=$("#is_hot").attr("checked")?1:0;
                    this.goodInfo.is_recommend=$("#is_recommend").attr("checked")?1:0;
                    this.goodInfo.is_member_discount=$("#is_member_discount").attr("checked")?1:0;
                    this.goodInfo.quality=$("#quality").attr("checked")?1:0;
                    this.goodInfo.seven=$("#seven").attr("checked")?1:0;
                    this.goodInfo.repair=$("#repair").attr("checked")?1:0;
                    this.goodInfo.can_no_trefund=$("#can_no_trefund").attr("checked")?1:0;
                    this.goodInfo.is_main=$("#is_main").attr("checked")?1:0;

                    this.$http.post("{:url('goods/addOrUpdateGoods')}", this.goodInfo,
                            {emulateJSON: true}).then(function (res) {
                        if (res.data.code == 0) {
                            var lay = layer.alert(res.data.msg, {icon: 6, title: '提示'}, function () {
                                goodInfo.getUrl(res.data.data);
                            });
                        } else {
                            layer.alert(res.data.msg, {icon: 6, title: '提示'});
                        }
                    }, function (res) {
                        layer.alert("操作失败，请稍后重试", {icon: 6, title: '提示'});
                    });
                },
                getUrl: function (index) {
                    this.$http.post("{:url('index/getUrl')}", {type: 'updateGood', id: index},
                            {emulateJSON: true}).then(function (res) {
                        if (res.data.result == "OK") {
                            location.href = res.data.url;
                        }
                    });
                },
                //添加规格
                insertFormat: function () {
                    this.tableTh = [];
                    this.formatInfo = [];
                    var index = 1;
                    for (i = 0; i < this.format.length; i++) {
                        this.format[i].sort = i + 1;
                        for (j = 0; j < this.format[i].spec_item_array.length; j++) {
                            this.format[i].spec_item_array[j].sort = j + 1;
                            this.format[i].spec_item_array[j].item_id = index;
                            index++;
                        }
                    }
                },
                addFormat: function () {
                    this.format.push({spec_id: '', goods_id: '', title: '', sort: '', spec_item_array: []});
                    this.insertFormat();
                },
                delFormat: function (index) {
                    this.format.splice(index, 1);
                    this.insertFormat();

                },
                addFormatList: function (index) {
                    this.format[index].spec_item_array.push({
                        spec_item_id: '',
                        item_id: '',
                        spec_id: '',
                        title: '',
                        thumb: '',
                        sort: ''
                    });
                    this.insertFormat();

                },
                delFormatList: function (index1, index2) {
                    this.format[index1].spec_item_array.splice(index2, 1);
                    this.insertFormat();
                },
                getTable: function () {
                    //创建表数据
                    this.tableTh = [];
                    this.formatInfo = [];
                    var arr = ['预售价', '市场价', '现价', '成本价', '库存', '重量', '体积', '编码', '条码'];
                    var arrNum = [];
                    for (i = 0; i < this.format.length; i++) {
                        if (this.format[i].spec_item_array.length == 0) {
                            this.tableTh = [];
                            layer.alert('每个规格至少包含一个规格项', {icon: 6, title: '提示'});
                            return;
                        }
                        if (this.format[i].title == '') {
                            this.tableTh = [];
                            layer.alert('规格名称不能为空', {icon: 6, title: '提示'});
                            return;
                        }
                        for (j = 0; j < this.format[i].spec_item_array.length; j++) {
                            if (this.format[i].spec_item_array[j].title == '') {
                                this.tableTh = [];
                                layer.alert('规格项不能为空', {icon: 6, title: '提示'});
                                return;
                            }
                        }
                        this.tableTh.push(this.format[i].title);
                        arrNum[i] = 0;
                    }
                    this.tableTh = this.tableTh.concat(arr);
                    var index = arrNum.length - 1;
                    this.formatInfo = [];
                    var result = true;
                    do {
                        this.formatInfo.push({
                            titleList: [],
                            sku_id: "",
                            sku_item_id: "",
                            goods_id: "",
                            title: "",
                            thumb: "",
                            presell_price: "",
                            market_price: "",
                            price: "",
                            cost_price: "",
                            stock: "",
                            weight: "",
                            volume: "",
                            goods_sn: "",
                            product_sn: ""
                        });
                        for (i = 0; i < arrNum.length; i++) {
                            this.formatInfo[this.formatInfo.length - 1].titleList.push(this.format[i].spec_item_array[arrNum[i]].title);
                            if (i == arrNum.length - 1) {
                                this.formatInfo[this.formatInfo.length - 1].title += this.format[i].spec_item_array[arrNum[i]].title;
                                this.formatInfo[this.formatInfo.length - 1].sku_item_id += this.format[i].spec_item_array[arrNum[i]].item_id;
                            } else {
                                this.formatInfo[this.formatInfo.length - 1].title += this.format[i].spec_item_array[arrNum[i]].title + "+";
                                this.formatInfo[this.formatInfo.length - 1].sku_item_id += this.format[i].spec_item_array[arrNum[i]].item_id + ",";
                            }
                        }
                        while (true) {
                            arrNum[index]++;
                            if (arrNum[index] == this.format[index].spec_item_array.length) {
                                arrNum[index] = 0;
                                index--;
                                if (index < 0) {
                                    result = false;
                                    break;
                                }
                            } else {
                                break;
                            }
                        }
                        index = arrNum.length - 1;
                    } while (result);
                },
                setPrice: function (value, index) {
                    for (i = 0; i < this.formatInfo.length; i++) {
                        this.formatInfo[i][index] = value;
                    }
                },
                delImg: function (index) {
                    this.thumb.splice(index, 1);
                },
                addStock:function(index){
                    for(var i=0;i<this.selectStock.length;i++){
                        if(this.selectStock[i].goods_id==this.stock[index].id){
                            layer.msg("该原料已经添加",{shade:[0.2,'#393D49']});
                            return;
                        }
                    }
                    this.selectStock.push({id:0,goods_id:this.stock[index].id,title:this.stock[index].title,number:this.changeNumToDec(1,2),img:this.stock[index].pic_cover_micro,price:this.stock[index].price});


                },
                changeStockNum:function(index){
                    if(this.selectStock[index].number<=1){
                        layer.msg("原料数量不能小于1",{shade:[0.2,'#393D49']});
                        this.selectStock[index].number=this.changeNumToDec(1,2);
                    }else{
                        this.selectStock[index].number=this.changeNumToDec(parseInt(this.selectStock[index].number),2);


                    }
                },
                delStock:function(index){
                    this.selectStock.splice(index,1);
                },
                changeNumToDec:function(num,count){
                    return num.toFixed(count);
                }
            },
            computed:{
                stockTotal:function(){
                    var total=0;
                    for(var i=0;i<this.selectStock.length;i++){
                        total+=this.selectStock[i].number*this.selectStock[i].price;
                    }
                    return total;
                }
            }
        });
    });
</script>
<!--<script src="__STATIC__/admin/js/ns_common_base.js"></script>-->
<script src="__STATIC__/blue/js/ns_common_blue.js"></script>
<script>
    $(function () {
        //顶部导航管理显示隐藏
        $(".ns-navigation-title>span").click(function () {
            $(".ns-navigation-management").slideUp(400);
        });

        $(".js-nav").toggle(function () {
            $(".ns-navigation-management").slideDown(400);
        }, function () {
            $(".ns-navigation-management").slideUp(400);
        });
    });
    function showDiv(div, cla) {
        $("#daohang li").removeClass("selected");
        $("." + cla).addClass("selected");
        $('.ncsc-form-goods').hide();
        $(div).show();
    }
    function imgGoodsUpload(event) {
        var fileid = $(event).attr("id");
        var str = $(event).next().attr("id");
        var data = {
            "album_id": 0,
            "type": "1,2,3,4",
            'file_path': UPLOADGOODS
        };
        ;
        uploadFile(fileid, data, function (res) {
            if (res.state == 1) {

                goodInfo.thumb.push({id: res.file_id, url: res.file_name});
            } else {
                layer.alert("图片上传失败", {icon: 6, title: '提示'});
            }
        }, "{:url('util/ImgUpload/photoalbumupload')}");
    }
</script>
</body>
</html>